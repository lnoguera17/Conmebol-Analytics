---
title: "Model-FIFA"
author: "Luis Noguera"
date: "5/31/2020"
output: html_document
---

```{r setup, include=FALSE}
library(readxl)
library(tidyverse)

conmebol <- read_csv("conmebol.csv") 

conmebol <- conmebol %>% select(-X1)

```


# Data Cleaning

```{r}

conmebol <- conmebol %>%
  mutate(rating = as.numeric(rating))

```


# Data Exploration

```{r}
conmebol %>%
  mutate(nationality = fct_reorder(nationality, rating)) %>%
  ggplot(aes(nationality, rating, fill = nationality)) +
  geom_boxplot() +
  facet_wrap(~best_position, scales = 'free') +
  coord_flip()



conmebol %>%
  filter(best_position == 'ST') %>%
  mutate(foot = fct_reorder(foot, rating)) %>%
  ggplot(aes(foot, rating, fill = foot)) +
  geom_boxplot() +
  facet_wrap(~best_position, scales = 'free')



```

```{r}
# Visualization 

## Average per Country
Overall_avg_LATAM <- ggplot(stats, aes(reorder(nationality, -overall_avg), overall_avg))  +
  geom_text(aes(label = round(overall_avg,2)), hjust = -0.05) +
  geom_bar(stat = 'identity')  +
  labs(y= 'Overall Average',
       x= "Country") +
  theme_light() +
  coord_flip()
Overall_avg_LATAM


# World Map

## Loading Map data
worldmap <- map_data('world')

merged_data2 <- merge(x = worldmap, y = stats, by.x = 'region', by.y = 'nationality', all.x = TRUE) %>%
  arrange(order)

overall_map <- ggplot(data = merged_data2, aes(x = long, y = lat, group = group)) +
  geom_polygon(aes(fill = overall_avg)) +
  labs(fill='Total Player Counts')
overall_map

## Interactive Plot
ggplotly(overall_map)




```

